<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->



<!-- PolymerElement Components -->
<link rel="import" href="../bower_components/polymer/polymer.html" />
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html" />
<link rel="import" href="../bower_components/mapbox-gl/mapbox-gl.html" />
<link rel="import" href="shared-styles.html">

<!-- Predix UI Components -->
<!--<link rel="import" href="../components/px-map/px-map.html" />
<link rel="import" href="../components/px-map/px-map-tile-layer.html" />
<link rel="import" href="../components/px-map/px-map-control-zoom.html" />
<link rel="import" href="../components/px-map/px-map-layer-geojson.html" />-->

<!-- Theme/CSS -->
<link rel="import" href="../bower_components/px-theme/px-theme-styles.html">


<dom-module id="my-view1">
  <template>
    <style include="shared-styles">
      /*:host {
        display: block;

        padding: 10px;
      }*/

      :host {
        width: 100vw;
        height: 100vh;
      }
      :root {
        --px-map-icon-info-color: rgb(70,173,0);
      }
      .map, #map {
        flex: 1;
        display: flex;
        height: 550px;
        width: 100%;
      }
    </style>


    <!--<iron-ajax
        id="ajax"
        url="/src/fac.geojson"
        last-response="{{rawRequests}}"
        handle-as="json"
        debounce-duration="300"
        auto verbose>
    </iron-ajax>-->


    <!--<div class="card">
        <h1> Show me ... </h1>
    </div>-->

    <div class="card">

        <div class="map">
           <mapbox-gl id="map"
	    interactive
	    map="{{map}}"
	    map-style="mapbox://styles/mapbox/streets-v9"
	    access-token="pk.eyJ1IjoiYXZlZHkiLCJhIjoiY2l2NDQ1bG9oMDA0aDJ0cWx4ZW50aTJkbiJ9.WPiw3lvIkzQcABAfJj2MBQ"
	    latitude=32.7157
	    longitude=-117.1611
	    zoom=12
	    pitch=0
	    bearing=0
	   ></mapbox-gl>

       <mapbox-layer
          map="[[map]]"
          layer-id="buildings"
          rendering-type="circle"
          source="geojsonsrc"
          color="#009688"
          opacity=0.7
          ></mapbox-layer>

         <geojson-source
          map="[[map]]"
          source-id="geojsonsrc"
          source-data="/src/fac.geojson"></geojson-source>


        </div>


          <!-- leftovers -->
          <!--<px-map-control-zoom position="bottomright"></px-map-control-zoom>-->
          <!--<px-map lat="[[mapLat]]" lng="[[mapLng]]" zoom="[[mapZoom]]" flex-to-size>-->
          <!--<px-map-marker-group name="Requests" data="{{requests}}"></px-map-marker-group>-->
        <!--<div class="map">
          <px-map lat="32.727364280927794" lng="-117.16884613037111" zoom="13" flex-to-size>
          <px-map-tile-layer url="http://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"></px-map-tile-layer>
          <px-map-layer-geojson data="{{requests}}" show-feature-properties></px-map-layer-geojson>
          </px-map>
      </div>-->

    </div>
  </template>

  <script>
    Polymer({
      is: 'my-view1',
      properties: {
        requests: {
            type: Object,
            notify: true,
            reflectToAttribute: true
        },
        rawRequests: {
            type: Object,
            observer: '_processRequestsJSON'
        }
      },
      attached: function() {
          console.log('hello');
      },
      _processRequestsJSON: function(raw) {
          console.log(raw);
          this.set('requests', raw);
      }
    });
  </script>
</dom-module>
